import{u as _}from"./index-ggp1Pec8.js";import{b as y,e as r,l as g,m as h,p as A,o as x,c as C,_ as R}from"./index-lD9uo4t3.js";const B=y({__name:"SongEffect",setup(S){const n=_(),{connectAudioContext:f,disConnectAudioContext:m}=n,s=r(()=>n.audioRef),a=r(()=>n.analyser),d=r(()=>n.isPlaying);let i;const l=g();function u(){if(a.value&&l.value){i=requestAnimationFrame(()=>{u()});const t=new Uint8Array(a.value.frequencyBinCount);a.value.getByteTimeDomainData(t);const e=l.value,o=e.getContext("2d");if(o){o.clearRect(0,0,e.width,e.height);for(let c=0;c<t.length;c++){const v=t[c]/256,p=e.height-e.height*v;o.fillStyle="white",o.fillRect(c,p,1,1)}}}}return h(()=>{s.value&&(f(),a.value&&d&&u(),s.value.onplay=()=>{u()},s.value.onpause=()=>{cancelAnimationFrame(i)})}),A(()=>{m(),cancelAnimationFrame(i)}),(t,e)=>(x(),C("canvas",{ref_key:"canvasRef",ref:l,class:"song-effect-canvas"},null,512))}}),F=R(B,[["__scopeId","data-v-f6775baf"]]);export{F as default};
